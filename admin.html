<!DOCTYPE html>
<html>
<head>
<title>Admin Panel</title>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

// Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyCsGBSRCHVUhXQZ5DNMEZWgQWk1gxMF1E4",
  authDomain: "signup-d32c5.firebaseapp.com",
  projectId: "signup-d32c5",
  storageBucket: "signup-d32c5.firebasestorage.app",
  messagingSenderId: "583812949955",
  appId: "1:583812949955:web:fab1bb7be94bc1b4ab3f76",
  measurementId: "G-VLC3QHK8CG"
};

// Init Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

async function loadData() {
  const qData = query(collection(db, "visitors"), orderBy("time", "desc"));
  const q = await getDocs(qData);

  q.forEach(docSnap => {
    let d = docSnap.data();

    document.getElementById("log").innerHTML += `
      <div style="margin:8px;padding:10px;border:1px solid #ccc;border-radius:8px;background:#f9f9f9">
        ğŸ“± <b>Device:</b> ${d.deviceModel || "Unknown"}<br>
        ğŸ’» <b>OS:</b> ${d.os || "N/A"}<br>
        ğŸŒ <b>User Agent:</b> <small>${d.userAgent}</small><br><br>

        ğŸ”‹ <b>Battery:</b> ${d.battery || "?"}  
        âš¡ <b>Charging:</b> ${d.charging ? "Yes" : "No"}<br><br>

        ğŸ“ <b>Location:</b> ${d.location || "Not Allowed"}<br><br>

        â° <b>First Visit:</b> ${
          d.time?.toDate ? d.time.toDate().toLocaleString() : d.time
        }<br>
        ğŸ•’ <b>Last Update:</b> ${
          d.lastUpdate?.toDate ? d.lastUpdate.toDate().toLocaleString() : d.lastUpdate || "N/A"
        }
      </div>
    `;
  });
}

window.onload = loadData;
</script>

</head>
<body style="font-family:Arial;padding:20px;">
<h2>Admin Dashboard âš¡</h2>
<p>Live Device Logger</p>
<hr>

<div id="log"></div>

</body>
</html>
