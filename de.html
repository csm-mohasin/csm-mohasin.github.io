<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Delivery Dashboard â€” Live Tracking</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

<style>
body {
  margin: 0;
  background: #e8eef6;
  font-family: Arial, sans-serif;
  text-align: center;
}
#map {
  height: 500px;
  width: 95%;
  margin: auto;
  border-radius: 12px;
}
h2 {
  padding: 10px;
}
</style>

<!-- Firebase Scripts -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
// Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyCsGBSRCHVUhXQZ5DNMEZWgQWk1gxMF1E4",
  authDomain: "signup-d32c5.firebaseapp.com",
  projectId: "signup-d32c5",
  storageBucket: "signup-d32c5.firebasestorage.app",
  messagingSenderId: "583812949955",
  appId: "1:583812949955:web:fab1bb7be94bc1b4ab3f76",
  databaseURL: "https://signup-d32c5-default-rtdb.firebaseio.com/"
};
firebase.initializeApp(firebaseConfig);
</script>

</head>
<body>

<h2>ðŸšš Delivery Dashboard â€” Live Tracking</h2>
<div id="map"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
var map = L.map('map').setView([23.8103, 90.4125], 10); // Initial Dhaka view
var marker;

// Map layers
var normalMap = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');
var satelliteMap = L.tileLayer('https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
  subdomains:['mt0','mt1','mt2','mt3']
});

normalMap.addTo(map);

L.control.layers({
  "Normal": normalMap,
  "Satellite": satelliteMap
}).addTo(map);

// Firebase listener
firebase.database().ref("location").limitToLast(1).on("child_added", function(snapshot) {
  var data = snapshot.val();
  var lat = data.latitude;
  var lon = data.longitude;

  // Update marker
  if (!marker) {
    marker = L.marker([lat, lon]).addTo(map);
  } else {
    marker.setLatLng([lat, lon]);
  }

  // Move map center to live position
  map.setView([lat, lon], 15);

});
</script>

</body>
</html>
