<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸšš Delivery Dashboard â€” Live Tracking</title>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #e8f2ff;
        text-align: center;
    }
    h2 {
        margin: 10px 0;
        padding: 10px;
        background: white;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    #map {
        height: 90vh;
        width: 95vw;
        margin: auto;
        border-radius: 12px;
        box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    }
</style>
</head>

<body>

<h2>ðŸšš Delivery Dashboard â€” Live Tracking</h2>
<div id="map"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-database.js";

// âœ… Replace with YOUR Firebase config
const firebaseConfig = {
  apiKey: "YOUR_KEY",
  authDomain: "YOUR_DOMAIN",
  databaseURL: "https://signup-d32c5-default-rtdb.firebaseio.com/",
  projectId: "signup-d32c5",
  storageBucket: "signup-d32c5.appspot.com",
  messagingSenderId: "YOUR_ID",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// âœ… Firebase location path
const locationRef = ref(db, "location");


// âœ… Leaflet map setup (Initial Dhaka View)
const map = L.map("map").setView([23.7509, 90.3934], 13);

// ðŸŒ Normal + Satellite Layer
const normalLayer = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png");
const satelliteLayer = L.tileLayer(
  "https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"
);

// Default layer
normalLayer.addTo(map);

// Layer control button
L.control.layers(
  { "ðŸ—º Normal": normalLayer, "ðŸ›° Satellite": satelliteLayer }
).addTo(map);


// âœ… Marker setup (Truck icon)
const truckIcon = L.icon({
  iconUrl: "https://cdn-icons-png.flaticon.com/512/1995/1995502.png",
  iconSize: [40, 40],
});

let marker = L.marker([23.7509, 90.3934], { icon: truckIcon }).addTo(map);


// âœ… Firebase real-time location update
onValue(locationRef, (snapshot) => {
  const data = snapshot.val();
  if (!data) return;

  const { latitude, longitude } = data;

  marker.setLatLng([latitude, longitude]);

  // Map move with marker â€” comment this line if you don't want auto-follow
  map.setView([latitude, longitude]);
});
</script>

</body>
</html>
