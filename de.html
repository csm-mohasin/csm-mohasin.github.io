<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Delivery Dashboard â€” Live Tracking</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
body{background:#e9eef5;font-family:Arial}
#map{height:400px;border-radius:12px}
.container{width:95%;margin:auto;margin-top:10px}
.card{background:white;padding:10px;border-radius:10px;margin-top:10px}
</style>
</head>
<body>

<div class="container">
<h2>ğŸšš Delivery Dashboard â€” Live Tracking</h2>
<div id="map"></div>
<div id="log"></div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
// Map layers
var normal = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png");
var sat = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',{
 maxZoom:20,subdomains:['mt0','mt1','mt2','mt3']
});

var map = L.map("map",{center:[23.81,90.41],zoom:10,layers:[normal]});
L.control.layers({"Default":normal,"Satellite":sat}).addTo(map);
var marker = L.marker([23.81,90.41]).addTo(map);

// Fetch Firebase location
async function fetchLocation(){
 let res = await fetch("https://signup-d32c5-default-rtdb.firebaseio.com/location.json");
 let d = await res.json(); if(!d) return;

 marker.setLatLng([d.lat,d.lng]);
 map.setView([d.lat,d.lng],15);

 marker.bindPopup(`ğŸ“ ${d.lat},${d.lng}<br>ğŸ”‹ ${d.battery}%`).openPopup();

 document.getElementById("log").innerHTML = `
 <div class='card'>
  <b>${d.device}</b><br>
  Lat: ${d.lat}, Lng: ${d.lng}<br>
  Battery: ${d.battery}%<br>
  ${d.time}
 </div>
 ` + document.getElementById("log").innerHTML;
}
setInterval(fetchLocation,3000);
</script>
</body>
</html>
